---
title: 浅试了一下Notion，感觉没有Google Sheets好用
tags: default
---

故事的开头，总是那么朴实无华。我心血来潮，想为自己的投资整一个记录表。核心需求就俩：**股价能实时更新，数据得云端同步。**

## 第一站：颜值担当 Notion

说到 All-in-one 和云端同步，第一个想到的自然是 Notion。市面上的投资模板眼花缭乱，但都不合我的胃口，那还不如自己动手，丰衣足食。

一番摸索下来，我对 Notion 数据库的理解是这样的（不一定全对，欢迎大佬指正）：

-   一个 Notion 数据库，骨子里就是一张 SQL 数据表。
-   数据库的各种视图（View），像是给这张表套上了不同的滤镜和皮肤，本质还是同一份数据。
-   表里的一行记录（Row），在 Notion 里被赋予了灵魂，被称为一个页面（Page），可以无限展开。
-   数据库之间可以建立关联（Relation），实现单向或双向的“眉目传情”。

一开始，我确实玩得很嗨。Notion 灵活的数据库和页面设计，让我感觉自己像在玩乐高，自由组合，创意无限。但当我兴致勃勃地准备大展拳脚，开始做数据统计时，现实的铁拳就砸了下来。

**痛点一：被“囚禁”在单行里的公式**

Notion 的公式（Formula）能力，其作用域被严格限制在**单行（Page）之内**。这意味着，你没法在一个单元格里写个公式，去引用**另一行**的数据。

举个栗子，我想计算“某支股票的市值占总投资的百分比”。这个公式需要两个数：“单支股票市值”（来自当前行）和“总投资额”（需要汇总所有行）。问题来了，Notion 的公式拿不到那个“总投资额”。

唯一的解法是“曲线救国”：
1.  再新建一个“汇总专用”数据库。
2.  用 Relation 属性把所有投资记录，都手动关联到这个“汇总库”的**唯一一行**上。
3.  在新库里用 Rollup 功能，把关联页面的金额汇总求和。
4.  最后再把这个汇总值，通过 Relation 带回到原始数据库的每一行里，才能进行计算。

这一套操作下来，我人已经麻了。

**痛点二：缺失的自动化聚合能力**

我希望实现一个效果：当我在“交易记录”库里买了一笔新的股票（比如第一次买入 AAPL），我的“持仓汇总”库能自动多出 “AAPL” 这一行，并开始累加我对它的所有投资。

但在 Notion 里，这事儿得“亲力亲为”：
1.  你得先**手动**去“持仓汇总”库里，创建一个名为 “AAPL” 的新页面。
2.  然后再回到“交易记录”库里，把这笔新交易**手动**关联到你刚才创建的 “AAPL” 页面上。

每增加一个新的投资标的，就得重复一次这套机械劳动。说好的 All-in-one 呢？这自动化程度，感觉还停留在石器时代。

![notion](https://raw.githubusercontent.com/pzweuj/pzweuj.github.io/refs/heads/master/content/data/images/20250829_notion.png)

虽然我甚至为 Notion 写了个自动更新股价的小工具 [NoFina](https://github.com/pzweuj/NoFina)（基于 Finnhub API，5分钟一刷），但这些核心功能的缺失，让我感觉像开着一辆内饰豪华但引擎是拖拉机的跑车。在碰了几天南墙之后，我决定——换车！

## 第二站：返璞归真 Google Sheets

回到 Google Sheets 的怀抱，那感觉，就一个字：**舒坦**！

那熟悉的电子表格界面，简直是刻在 DNA 里的肌肉记忆，上手成本？不存在的。

之前在 Notion 里绕到天昏地暗的两个痛点，在这里简直是小菜一碟：
-   **跨行计算？** `SUM()`、`SUMIF()` 随便用，算个占比简直不要太轻松。
-   **自动聚合？** 一个 `=UNIQUE(FILTER())` 公式，就能自动从交易记录表里抓取所有不重复的股票代码，生成清爽的汇总列表。新增交易？列表自动更新，完全不用我操心！

再加上单元格的条件格式，轻松就能调教出比 Notion 更直观、更花里胡哨的数据看板。通过挂载 Google Drive，还能每天把这份快乐同步回本地备份。

![GS_1](https://raw.githubusercontent.com/pzweuj/pzweuj.github.io/refs/heads/master/content/data/images/20250829_gs_1.png)

当然，Google Sheets 也不是完美无缺。它自带的 `=GOOGLEFINANCE()` 函数虽然强大，能搞定大部分股票和汇率，但偏偏不支持加密货币，而且有 20 分钟的更新延迟。咱玩的就是心跳，这怎么能忍？

市面上的插件看了一圈，感觉都不够清爽。于是，熟悉的剧情再次上演——**自己动手，丰衣足食！**

我用 Javascript 写了个简单的 App 脚本（后缀是`.gs`），直接部署在 Google Sheets 里，继续调用 Finnhub API 来拉取股价和加密货币价格。搞定！

-   脚本扔这儿了: [finnhub_auto.gs](https://github.com/pzweuj/NoFina/blob/main/finnhub_auto.gs)
-   食用方法见这里: [README](https://github.com/pzweuj/NoFina?tab=readme-ov-file#google-sheets)

![GS_2](https://raw.githubusercontent.com/pzweuj/pzweuj.github.io/refs/heads/master/content/data/images/20250829_gs_2.png)

最终的效果让我极度舒适：我只需要在 `Records` 表中像记流水账一样，无脑录入每一笔交易。剩下的事情，表格会自动帮我分门别类地聚合到汇总表，并根据实时价格评估我的身家。

我还闲不住，让 Deepseek-V3.1（毕竟是幻方家的，总感觉自带量化 Buff）为我设计了一套简单的交易策略，也用公式写进了汇总表。现在，表格不仅是我的记账本，还是我的半个“量化”小助理，时不时给我一些买入/卖出的建议。

## 写在最后

从 Notion 到 Google Sheets，这次折腾不仅解决了我的核心需求，更让我明白了一个道理：**没有最好的工具，只有最适合自己工作流的工具。**

当然，最后还是要例行提醒一句：

⚠**投资有风险，入市需谨慎**⚠。祝大家发财！

---

（本文由Gemini生成）
